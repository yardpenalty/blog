tinymce.PluginManager.add("link",function(n){function i(t){return function(){var i=n.settings.link_list;typeof i=="string"?tinymce.util.XHR.send({url:i,success:function(n){t(tinymce.util.JSON.parse(n))}}):t(i)}}function t(t){function a(n){var t=h.find("#text");(!t.value()||n.lastControl&&t.value()==n.lastControl.text())&&t.value(n.control.text());h.find("#href").value(n.control.value())}function y(){var i=[{text:"None",value:""}];return tinymce.each(t,function(t){i.push({text:t.text||t.title,value:n.convertURL(t.value||t.url,"href"),menu:t.menu})}),i}function p(t){var i=[{text:"None",value:""}];return tinymce.each(n.settings.rel_list,function(n){i.push({text:n.text||n.title,value:n.value,selected:t===n.value})}),i}function w(t){var i=[{text:"None",value:""}];return n.settings.target_list||i.push({text:"New window",value:"_blank"}),tinymce.each(n.settings.target_list,function(n){i.push({text:n.text||n.title,value:n.value,selected:t===n.value})}),i}function b(t){var i=[];return tinymce.each(n.dom.select("a:not([href])"),function(n){var r=n.name||n.id;r&&i.push({text:r,value:"#"+r,selected:t.indexOf("#"+r)!=-1})}),i.length?(i.unshift({text:"None",value:""}),{name:"anchor",type:"listbox",label:"Anchors",values:i,onselect:a}):void 0}function v(){f&&f.value(n.convertURL(this.value(),"href"));e||r.text.length!==0||this.parent().parent().find("#text")[0].value(this.value())}var r={},o=n.selection,u=n.dom,s,i,e,h,f,c,l;s=o.getNode();i=u.getParent(s,"a[href]");r.text=e=i?i.innerText||i.textContent:o.getContent({format:"text"});r.href=i?u.getAttrib(i,"href"):"";r.target=i?u.getAttrib(i,"target"):"";r.rel=i?u.getAttrib(i,"rel"):"";s.nodeName=="IMG"&&(r.text=e=" ");t&&(f={type:"listbox",label:"Link list",values:y(),onselect:a,value:n.convertURL(r.href,"href"),onPostRender:function(){f=this}});n.settings.target_list!==!1&&(l={name:"target",type:"listbox",label:"Target",values:w(r.target)});n.settings.rel_list&&(c={name:"rel",type:"listbox",label:"Rel",values:p(r.rel)});h=n.windowManager.open({title:"Insert link",data:r,body:[{name:"href",type:"filepicker",filetype:"file",size:40,autofocus:!0,label:"Url",onchange:v,onkeyup:v},{name:"text",type:"textbox",size:40,label:"Text to display",onchange:function(){r.text=this.value()}},b(r.href),f,c,l],onSubmit:function(t){function h(t,i){window.setTimeout(function(){n.windowManager.confirm(t,i)},0)}function s(){r.text!=e?i?(n.focus(),i.innerHTML=r.text,u.setAttribs(i,{href:f,target:r.target?r.target:null,rel:r.rel?r.rel:null}),o.select(i)):n.insertContent(u.createHTML("a",{href:f,target:r.target?r.target:null,rel:r.rel?r.rel:null},r.text)):n.execCommand("mceInsertLink",!1,{href:f,target:r.target,rel:r.rel?r.rel:null})}var r=t.data,f=r.href;if(!f){n.execCommand("unlink");return}if(f.indexOf("@")>0&&f.indexOf("//")==-1&&f.indexOf("mailto:")==-1){h("The URL you entered seems to be an email address. Do you want to add the required mailto: prefix?",function(n){n&&(f="mailto:"+f);s()});return}if(/^\s*www\./i.test(f)){h("The URL you entered seems to be an external link. Do you want to add the required http:// prefix?",function(n){n&&(f="http://"+f);s()});return}s()}})}n.addButton("link",{icon:"link",tooltip:"Insert/edit link",shortcut:"Ctrl+K",onclick:i(t),stateSelector:"a[href]"});n.addButton("unlink",{icon:"unlink",tooltip:"Remove link",cmd:"unlink",stateSelector:"a[href]"});n.addShortcut("Ctrl+K","",i(t));this.showDialog=t;n.addMenuItem("link",{icon:"link",text:"Insert link",shortcut:"Ctrl+K",onclick:i(t),stateSelector:"a[href]",context:"insert",prependToContext:!0})});
/*
//# sourceMappingURL=plugin.min.js.map
*/