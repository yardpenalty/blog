(function(n,t){"use strict";function u(n,t){for(var u,e=[],r=0;r<n.length;++r){if(u=i[n[r]]||f(n[r]),!u)throw"module definition dependecy not found: "+n[r];e.push(u)}t.apply(null,e)}function r(n,r,f){if(typeof n!="string")throw"invalid module definition, module id must be defined and be a string";if(r===t)throw"invalid module definition, dependencies must be specified";if(f===t)throw"invalid module definition, definition function must be specified";u(r,function(){i[n]=f.apply(null,arguments)})}function f(t){for(var i=n,u=t.split(/[.\/]/),r=0;r<u.length;++r){if(!i[u[r]])return;i=i[u[r]]}return i}function e(r){for(var f,o=0;o<r.length;o++){var e=n,s=r[o],u=s.split(/[.\/]/);for(f=0;f<u.length-1;++f)e[u[f]]===t&&(e[u[f]]={}),e=e[u[f]];e[u[u.length-1]]=i[s]}}var i={};r("tinymce/spellcheckerplugin/DomTextMatcher",[],function(){return function(n,t,i){function v(n){if(!n[0])throw"findAndReplaceDOMText cannot handle zero-length matches";var t=n.index;return[t,t+n[0].length,[n[0]]]}function l(n){var t;if(n.nodeType===3)return n.data;if(o[n.nodeName]&&!f[n.nodeName])return"";if(t="",(f[n.nodeName]||s[n.nodeName])&&(t+="\n"),n=n.firstChild)do t+=l(n);while(n=n.nextSibling);return t}function y(n,t,i){var h,c,v,l,a=[],u=0,r=n,e=t.shift(),y=0;n:for(;;){if((f[r.nodeName]||s[r.nodeName])&&u++,r.nodeType===3&&(!c&&r.length+u>=e[1]?(c=r,l=e[1]-u):h&&a.push(r),!h&&r.length+u>e[0]&&(h=r,v=e[0]-u),u+=r.length),h&&c){if(r=i({startNode:h,startNodeIndex:v,endNode:c,endNodeIndex:l,innerNodes:a,match:e[2],matchIndex:y}),u-=c.length-l,h=null,c=null,a=[],e=t.shift(),y++,!e)break}else if((!o[r.nodeName]||f[r.nodeName])&&r.firstChild){r=r.firstChild;continue}else if(r.nextSibling){r=r.nextSibling;continue}for(;;)if(r.nextSibling){r=r.nextSibling;break}else if(r.parentNode!==n)r=r.parentNode;else break n}}function p(n){var t,i;return typeof n!="function"?(i=n.nodeType?n:u.createElement(n),t=function(n,t){var r=i.cloneNode(!1);return r.setAttribute("data-mce-index",t),n&&r.appendChild(u.createTextNode(n)),r}):t=n,function(n){var o,s,i,f=n.startNode,e=n.endNode,h=n.matchIndex,r,a,p,w,c,b,l,v,y;if(f===e)return r=f,i=r.parentNode,n.startNodeIndex>0&&(o=u.createTextNode(r.data.substring(0,n.startNodeIndex)),i.insertBefore(o,r)),a=t(n.match[0],h),i.insertBefore(a,r),n.endNodeIndex<r.length&&(s=u.createTextNode(r.data.substring(n.endNodeIndex)),i.insertBefore(s,r)),r.parentNode.removeChild(r),a;for(o=u.createTextNode(f.data.substring(0,n.startNodeIndex)),s=u.createTextNode(e.data.substring(n.endNodeIndex)),p=t(f.data.substring(n.startNodeIndex),h),w=[],c=0,b=n.innerNodes.length;c<b;++c)l=n.innerNodes[c],v=t(l.data,h),l.parentNode.replaceChild(v,l),w.push(v);return y=t(e.data.substring(0,n.endNodeIndex),h),i=f.parentNode,i.insertBefore(o,f),i.insertBefore(p,f),i.removeChild(f),i=e.parentNode,i.insertBefore(y,e),i.insertBefore(s,e),i.removeChild(e),y}}function w(n){var t=[];return a(function(i,r){n(i,r)&&t.push(i)}),r=t,this}function a(n){for(var t=0,i=r.length;t<i;t++)if(n(r[t],t)===!1)break;return this}function b(n){return r.length&&(c=r.length,y(t,r,p(n))),this}var h,r=[],e,c=0,u,f,o,s;if(u=t.ownerDocument,f=i.getBlockElements(),o=i.getWhiteSpaceElements(),s=i.getShortEndedElements(),e=l(t),e&&n.global)while(h=n.exec(e))r.push(v(h));return{text:e,count:c,matches:r,each:a,filter:w,mark:b}}});r("tinymce/spellcheckerplugin/Plugin",["tinymce/spellcheckerplugin/DomTextMatcher","tinymce/PluginManager","tinymce/util/Tools","tinymce/ui/Menu","tinymce/dom/DOMUtils","tinymce/util/JSONRequest","tinymce/util/URI"],function(n,t,i,r,u,f,e){t.add("spellchecker",function(t,o){function b(n){for(var t in n)return!1;return!0}function k(n,f){var o=[],c=v[f],e,h;i.each(c,function(n){o.push({text:n,onclick:function(){t.insertContent(n);p()}})});o.push.apply(o,[{text:"-"},{text:"Ignore",onclick:function(){w(n,f)}},{text:"Ignore all",onclick:function(){w(n,f,!0)}},{text:"Finish",onclick:a}]);s=new r({items:o,context:"contextmenu",onautohide:function(n){n.target.className.indexOf("spellchecker")!=-1&&n.preventDefault()},onhide:function(){s.remove();s=null}});s.renderTo(document.body);e=u.DOM.getPos(t.getContentAreaContainer());h=t.dom.getPos(n);e.x+=h.x;e.y+=h.y;s.moveTo(e.x,e.y+n.offsetHeight)}function y(){function y(n){if(t.setProgressState(!1),b(n)){t.windowManager.alert("No misspellings found");h=!1;return}v=n;i.filter(function(t){return!!n[t[2][0]]}).mark(t.dom.create("span",{"class":"mce-spellchecker-word","data-mce-bogus":1}));i=null;t.fire("SpellcheckStart")}function p(n,r,u){f.sendRPC({url:new e(o).toAbsolute(c.spellchecker_rpc_url),method:n,params:{lang:c.spellchecker_language||"en",words:r},success:function(n){u(n)},error:function(n,r){n=n=="JSON Parse error."?"Non JSON response:"+r.responseText:"Error: "+n;t.windowManager.alert(n);t.setProgressState(!1);i=null;h=!1}})}var i,r=[],u={},s,l;if(h){a();return}h=!0;s=t.getParam("spellchecker_wordchar_pattern")||new RegExp('[^\\s!"#$%&()*+,-./:;<=>?@[\\]^_{|}`§©«®±¶·¸»¼½¾¿×÷¤”“„]+',"g");i=new n(s,t.getBody(),t.schema).each(function(n){var t=n[2][0];if(!u[t]){if(/^\d+$/.test(t)||t.length==1)return;r.push(t);u[t]=!0}});t.setProgressState(!0);l=c.spellchecker_callback||p;l("spellcheck",r,y)}function p(){t.dom.select("span.mce-spellchecker-word").length||a()}function l(n){var t=n.parentNode;t.insertBefore(n.firstChild,n);n.parentNode.removeChild(n)}function w(n,r,u){u?i.each(t.dom.select("span.mce-spellchecker-word"),function(n){var t=n.innerText||n.textContent;t==r&&l(n)}):l(n);p()}function a(){var i,r,n;for(h=!1,n=t.getBody(),r=n.getElementsByTagName("span"),i=r.length;i--;)n=r[i],n.getAttribute("data-mce-index")&&l(n);t.fire("SpellcheckEnd")}function d(n){var o,u,i,f=-1,s,e,r;for(n=""+n,o=t.getBody().getElementsByTagName("span"),u=0;u<o.length;u++)if(i=o[u],i.className=="mce-spellchecker-word"&&(f=i.getAttribute("data-mce-index"),f===n&&(f=n,s||(s=i.firstChild),e=i.firstChild),f!==n&&e))break;return r=t.dom.createRng(),r.setStart(s,0),r.setEnd(e,e.length),t.selection.setRng(r),r}var v,h,s,c=t.settings;t.on("click",function(n){if(n.target.className=="mce-spellchecker-word"){n.preventDefault();var t=d(n.target.getAttribute("data-mce-index"));k(n.target,t.toString())}});t.addMenuItem("spellchecker",{text:"Spellcheck",context:"tools",onclick:y,selectable:!0,onPostRender:function(){var n=this;t.on("SpellcheckStart SpellcheckEnd",function(){n.active(h)})}});t.addButton("spellchecker",{tooltip:"Spellcheck",onclick:y,onPostRender:function(){var n=this;t.on("SpellcheckStart SpellcheckEnd",function(){n.active(h)})}});t.on("remove",function(){s&&(s.remove(),s=null)})})});e(["tinymce/spellcheckerplugin/DomTextMatcher","tinymce/spellcheckerplugin/Plugin"])})(this);
/*
//# sourceMappingURL=plugin.min.js.map
*/